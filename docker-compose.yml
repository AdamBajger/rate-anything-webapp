# Docker Compose configuration for Rate Anything Web Application
# Provides easy deployment and management of the application

version: '3.8'

services:
  web:
    # Build from current directory
    build: .
    
    # Container name for easy reference
    container_name: rate-anything-app
    
    # Port mapping: host:container
    # Access application at http://localhost:8080
    ports:
      - "8080:80"
    
    # Volume mounts for persistent data
    # Uncomment to persist ratings across container restarts
    volumes:
      - ./data.yaml:/var/www/html/data.yaml
      # Uncomment to use custom configuration
      # - ./config.yaml:/var/www/html/config.yaml
    
    # Environment variables
    environment:
      # Set timezone for accurate timestamps
      - TZ=UTC
      # Production mode
      - APACHE_LOG_DIR=/var/log/apache2
    
    # Restart policy for production deployment
    restart: unless-stopped
    
    # Health check configuration
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost/"]
      interval: 30s
      timeout: 3s
      retries: 3
      start_period: 5s
    
    # Resource limits (adjust based on your needs)
    deploy:
      resources:
        limits:
          cpus: '1'
          memory: 512M
        reservations:
          cpus: '0.5'
          memory: 256M
